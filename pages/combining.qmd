---
title: "Combining Excel and Delimited Data"
format: html
toc: TRUE
editor_options: 
  chunk_output_type: inline
---

```{r}
library(tidyverse)
library(readxl)
library(readr)
```

## White Wine Data Set

*Reading in white wine data and manipulating it so 2nd page names are used to identify first page of data. Adding a column to designate these observations as "white" wine.*

```{r}
white_wine <- read_excel(
  "white-wine.xlsx",
  sheet = 1
)
white_wine

table_names <- read_excel(
  "white-wine.xlsx",
  sheet = 2
)

new_names <- table_names[[1]]
colnames(white_wine) <- new_names

white_wine <- white_wine |>
  mutate(type = "white")

white_wine

```

*Reading in red wine data set and manipulating the same way we did the white wine data set except these will be designated as type = "red"*

```{r}
red_wine <- read_delim(
  "red-wine.csv",
  delim = ";"
)

colnames(red_wine) <- new_names

red_wine <- red_wine |>
  mutate(type = "red")

red_wine


```

*Combining the two data sets. Filtering to only look at high quality wines (quality \> 0.5) that have a reasonable alcohol content (alcohol \< 132)*

```{r}
all_wines <- bind_rows(white_wine, red_wine)

hq_wine <- all_wines |>
  filter(quality > 6.5, alcohol < 132) |>
  arrange(desc(quality)) |>
  select(contains("acid"), alcohol, type, quality) |>
  group_by(quality)|>
  mutate(
    alc_mean_by_quality = mean(alcohol),
    alc_sd_by_quality = sd(alcohol)
  )

hq_wine
```
